# Описание

WEB-сервис для распознавания патологий на снимках КТ.

# Локальное развертывание

## Шаг 1. Клонирование репозиториев

Адреса подмодулей указаны для **SSH**. Вам нужно добавить ключ **SSH** в профиле GitHub.  Клонируйте репозиторий с вытягиванием всех подмодулей:

```bash
git clone --recurse-submodules git@github.com:mediside/deploy.git mediside
cd mediside
```

## Шаг 2. Генерация пароля

Сервис закрыт простой авторизацией. Используйте следующую команду для генерации пароля для пользователя **admin**:


```bash
htpasswd -c ./web/htpasswd admin
```

В терминале вам будет предложено ввести пароль. Запомните его - он понадобится для доступа к Web-интерфейсу

## Шаг 3. Установка адреса

Web-интерфейсу нужно знать, по какому адресу работает сервер. В файле `./web/.env` описан этот адрес для HTTP и WebSocket:

```bash
# файл .env
VITE_PROD_API_URL=http://localhost:80/api/v1/
VITE_PROD_WS_URL=ws://localhost:80/api/v1/
```

В таком случае Web-интерфейс будет работать только на том ПК, на котором будет запущен Docker Compose. Если вам это подходит, то можно не менять конфиги на этом шаге.

Но если у вас есть локальная сеть, и вы хотите развернуть сервис, чтобы его можно было использовать с других устройств в этой сети, то нужно создать файл `./web/.env.local` и прописать в него переменные с адресом вашего ПК в локальной сети. Этот файл переопределит переменные из `./web/.env`. Пример для адреса `192.168.1.123`:

```bash
# файл .env.local
VITE_PROD_API_URL=http://192.168.1.123:80/api/v1/
VITE_PROD_WS_URL=ws://192.168.1.123:80/api/v1/
```

## Шаг 4. Запуск

Выполните запуск контейнеров командой ниже:

```bash
docker compose up -d # запуск
docker copmose down # остановка и удаление
```

Откройте адрес `http://localhost:80 `в браузере (или адрес вашего сервера в локальной сети, например `http://192.168.1.123:80`). Должна появиться форма ввода логина и пароля. Введите данные для входа, полученные на втором шаге. Должен загрузиться Web-интерфейс.

# Разработка

```bash
docker compose -f docker-compose-dev.yaml up # запуск
docker copmose -f docker-compose-dev.yaml down # остановка и удаление
```